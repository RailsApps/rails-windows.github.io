<!DOCTYPE html>
<!--[if IE 9]><html class="lt-ie10" lang="en" > <![endif]-->
<html>
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Automated Install for Ruby on Rails on Windows &#183; Rails for Windows</title>
  <link href="https://plus.google.com/117374718581973393536" rel="publisher" />
  <link rel="stylesheet" href="http://rails-windows.github.io/css/foundation.css" />
  <link rel="stylesheet" href="http://rails-windows.github.io/css/screen.css" />
  <link rel="stylesheet" href="http://rails-windows.github.io/css/gollum.css" />
  <link rel="stylesheet" href="http://rails-windows.github.io/css/site.css" />
  <link rel="stylesheet" href="http://rails-windows.github.io/css/syntax.css" />
  <script src="http://rails-windows.github.io/javascript/modernizr.js" type="text/javascript"></script>
  <script src="http://rails-windows.github.io/javascript/jquery.js" type="text/javascript"></script>
  <script src="http://rails-windows.github.io/javascript/jquery.text_selection-1.0.0.min.js" type="text/javascript"></script>
  <script src="http://rails-windows.github.io/javascript/jquery.previewable_comment_form.js" type="text/javascript"></script>
  <script src="http://rails-windows.github.io/javascript/jquery.tabs.js" type="text/javascript"></script>
  <script src="http://rails-windows.github.io/javascript/gollum.js" type="text/javascript"></script>
  <script type="text/javascript"> window.analytics||(window.analytics=[]),window.analytics.methods=["identify","track","trackLink","trackForm","trackClick","trackSubmit","page","pageview","ab","alias","ready","group","on","once","off"],window.analytics.factory=function(t){return function(){var a=Array.prototype.slice.call(arguments);return a.unshift(t),window.analytics.push(a),window.analytics}};for(var i=0;i<window.analytics.methods.length;i++){var method=window.analytics.methods[i];window.analytics[method]=window.analytics.factory(method)}window.analytics.load=function(t){var a=document.createElement("script");a.type="text/javascript",a.async=!0,a.src=("https:"===document.location.protocol?"https://":"http://")+"d2dq2ahtl5zl1z.cloudfront.net/analytics.js/v1/"+t+"/analytics.min.js";var n=document.getElementsByTagName("script")[0];n.parentNode.insertBefore(a,n)},window.analytics.SNIPPET_VERSION="2.0.8",
  window.analytics.load("fajdc3qt0c");
  window.analytics.page();
  </script>
</head>
<body>

  <!-- Header and Nav -->
  <nav class="top-bar" data-topbar>
    <ul class="title-area">
      <!-- Title Area -->
      <li class="name">
        <h1>
          <a href="http://railsapps.github.io/" class="brand">RailsApps Project</a>
        </h1>
      </li>
      <li class="toggle-topbar menu-icon"><a href="#"><span>Menu</span></a></li>
    </ul>

    <section class="top-bar-section">
      <!-- Right Nav Section -->
      <ul class="right">
        <li class="divider"></li>
        <li><a href="https://tutorials.railsapps.org/" class="google">Tutorials</a></li>
        <li><a href="http://twitter.com/rails_apps" class="twitter">Twitter</a></li>
        <li><a href="http://blog.railsapps.org/" class="twitter">Blog</a></li>
        <li><a href="https://github.com/RailsApps" class="github">GitHub Repository</a></li>
        <li class="has-dropdown">
          <a href="#">Chapters</a>
          <ul class="dropdown">
            <li><label>Introduction</label></li>
            <li><a href="http://rails-windows.github.io/">Introduction to Ruby on Rails for Windows</a></li>
            <li class="divider"></li>
            <li><label>Chapter 01: Overview</label></li>
            <li><a href="http://rails-windows.github.io/10-install-ruby-rails-windows.html">Install Ruby on Rails on Windows</a></li>
            <li class="divider"></li>
            <li><label>Chapter 02: Getting Started</label></li>
            <li><a href="http://rails-windows.github.io/20-windows-environment-ruby-rails.html">Windows Environment for Ruby on Rails</a></li>
            <li><a href="http://rails-windows.github.io/30-software-ruby-rails-windows.html">Required Software for Ruby on Rails on Windows</a></li>
            <li class="divider"></li>
            <li><label>Chapter 03: Virtual Environments</label></li>
            <li><a href="http://rails-windows.github.io/40-virtual-machines-ruby-rails-windows.html">Virtual Machines for Ruby on Rails on Windows</a></li>
            <li class="divider"></li>
            <li><label>Chapter 04: Installations</label></li>
            <li><a href="http://rails-windows.github.io/50-automated-install-ruby-rails-windows.html">Automated Installation for Ruby on Rails on Windows</a></li>
            <li><a href="http://rails-windows.github.io/60-manual-install-ruby-rails-windows.html">Manual Installation for Ruby on Rails on Windows</a></li>
            <li class="divider"></li>
            <li><label>Chapter 05: Applications and Versioning</label></li>
            <li><a href="http://rails-windows.github.io/70-using-ruby-rails-windows.html">Using Ruby on Rails on Windows</a></li>
            <li><a href="http://rails-windows.github.io/80-git-github-ruby-rails-windows.html">Git and GitHub for Ruby on Rails on Windows</a></li>
            <li><a href="http://rails-windows.github.io/90-foundation-ruby-rails-windows.html">Foundation 5 for Ruby on Rails on Windows</a></li>
          </ul>
        </li>
      </ul>
    </section>

  </nav>
  <!-- End Header and Nav -->

  <div class="row">
    <div class="large-12 columns">
      <div class="content wikistyle gollum markdown">
        <h1>Automated Install for Ruby on Rails on Windows</h1>

<h4>by Joel Dezenzio</h4>

<p><em>Last updated 20 December 2013</em></p>

<hr><p><em>Rails for Windows</em></p>

<ul>
<li><a href="http://rails-windows.github.io/index.html">Introduction to Ruby on Rails for Windows</a></li>
<li><a href="http://rails-windows.github.io/10-install-ruby-rails-windows.html">Install Ruby on Rails on Windows</a></li>
<li><a href="http://rails-windows.github.io/20-windows-environment-ruby-rails.html">Windows Environment for Ruby on Rails</a></li>
<li><a href="http://rails-windows.github.io/30-software-ruby-rails-windows.html">Required Software for Ruby on Rails on Windows</a></li>
<li><a href="http://rails-windows.github.io/40-virtual-machines-ruby-rails-windows.html">Virtual Machines for Ruby on Rails on Windows</a></li>
<li><strong>Automated Install for Ruby on Rails on Windows</strong></li>
<li><a href="http://rails-windows.github.io/60-manual-install-ruby-rails-windows.html">Manual Installation for Ruby on Rails on Windows</a></li>
<li><a href="http://rails-windows.github.io/70-using-ruby-rails-windows.html">Using Ruby on Rails on Windows</a></li>
<li><a href="http://rails-windows.github.io/80-git-github-ruby-rails-windows.html">Git and GitHub for Ruby on Rails on Windows</a></li>
<li><a href="http://rails-windows.github.io/90-foundation-ruby-rails-windows.html">Foundation 5 for Ruby on Rails on Windows</a></li>
</ul><hr><h3>Automated Install</h3>

<p>This chapter will focus on automated package management installations with PowerShell, NuGet, Chocolatey, and BoxStarter.  There are some very short
manual processes you will need to follow first.</p>

<h4>PowerShell Scripting</h4>

<ol>
<li>Click the <strong>Windows</strong> key on your keyboard and type "Powershell", right-click on "Windows PowerShell" and pin to the "taskbar".</li>
<li>Click Desktop off the metro view window or just click the Windows key again on your keyboard to go back to the desktop.</li>
</ol><p>You should now see a PowerShell icon on your task bar.  Right-click and "Run as Administrator" to open a PS prompt.</p>

<h5>Execution Policy</h5>

<p>We will be changing the execution policy in PS so that we can run local and remote scripts going forwad. Run the following commands:</p>

<pre><code> C:\&gt; Get-ExecutionPolicy
</code></pre>

<p>You should see that it is set to "Restricted".  Let's change that</p>

<pre><code> C:\&gt; Set-ExeuctionPolicy unrestricted
</code></pre>

<p>When prompted, click Y for Yes and hit enter.  Now if you type Get-ExecutionPolicy you'll see it shows Unrestricted now.</p>

<pre><code> From this point forward, we will be working with automated scripting.
</code></pre>

<h3>Automated Installation</h3>

<h4><a href="http://boxstarter.org/">BoxStarter</a></h4>

<p>BoxStarter allows anyone to create an install script that can automate everything needed to install components onto the VM.  I've created an example script for this
purpose.  Open a web browser and navigate to the following URL:  <a href="https://github.com/elricstorm/wrails/blob/master/autoinstall">Rails 4 Windows Automation Script</a>.  This
is an example script showing the items we'll be installing.</p>

<p>In order to use boxstarter via a remote script like this we need to find the raw text and URL.  If you visit the link in the previous paragraph, you'll find that
Github includes a raw &lt;&gt; button that allows us to view the raw text.  The <a href="https://raw.github.com/elricstorm/wrails/master/autoinstall">raw text</a> can be found on
any GitHub repo by going to <a href="https://raw.github.com/somepath-to-some-project">https://raw.github.com/somepath-to-some-project</a>.</p>

<p>To start a boxstarter automated script you need to use:</p>

<div class="highlight">
<pre>START http://boxstarter.org/package/nr/url?
  followed by the URL to the raw text/script..
https://raw.github.com/elricstorm/wrails/master/autoinstall
</pre>
</div>


<p>When we put them both together we get:  START <a href="http://boxstarter.org/package/nr/url?https://raw.github.com/elricstorm/wrails/master/autoinstall">http://boxstarter.org/package/nr/url?https://raw.github.com/elricstorm/wrails/master/autoinstall</a></p>

<p>This one line will perform the following script automation tasks:</p>

<ul>
<li>Boxstarter will be installed</li>
<li>NuGet will be installed</li>
<li>Chocolatey will be installed</li>
<li>PS will be accessed from an elevated command prompt</li>
<li>UAC will be temporarily disabled</li>
<li>Any apps/scripts/gems listed in the raw text script will be initiated</li>
</ul><p>Copy this line into PowerShell:</p>

<pre>
  PS C:\&gt; START http://boxstarter.org/package/nr/url?https://raw.github.com/elricstorm/wrails/master/autoinstall
</pre>

<p>If you see any prompts, select the default <strong>Yes/Ok/Run/Download and Install this Feature</strong> prompts.  Automation should continue.  If prompted for a password, make sure to
use the Passw0rd! from the IEUser installation.</p>

<p><strong>THIS PROCESS WILL TAKE APPROXIMATELY 15 MINUTES TO COMPLETE</strong></p>

<p>During this process you will be prompted with dialog boxes that will ask if you want to proceed with an installation.  If you don't answer, the installation will
automatically commence after 5 seconds.  For the first automated process, do not cancel any of the installations.  Proceeed and install everything.</p>

<p>If you step away during this time and come back to find yourself at the Windows 8 metro view, click <strong>Desktop</strong> and the process will continue.  If Windows prompts
you to do system updates, you can cancel and update later on.</p>

<p>Always remember that you can restart the automated process again as often as you like.  Chocolatey will know if you have already installed an application and
bypass it, continuing on with the installation script.  I've also added some test path sequences and intelligence into the script to help determine if some
applications have already been installed.</p>

<p><a href="http://www.flickr.com/photos/69355230@N03/11263555476/" title="install_automated"><img src="http://farm4.staticflickr.com/3815/11263555476_1ba6eb50be_o.png" width="666" height="338" alt="install_automated"></a></p>

<p>Once everything is completed, the following window should show with Enabling UAC before the exit command:</p>

<p><a href="http://www.flickr.com/photos/69355230@N03/11263610373/" title="install_automated2"><img src="http://farm4.staticflickr.com/3789/11263610373_d46d568ca5_o.png" width="666" height="337" alt="install_automated2"></a></p>

<p>Once done, let's verify that mysql2 is working properly by opening IRB from a command prompt.</p>

<pre>
     C:\&gt; irb
     C:\&gt; require 'mysql2'
     =&gt; true
</pre>

<p>This should equal true.</p>

<p>If everything has gone fine so far, pat yourself on the back for a job well done!  The majority of the software you need has been installed.  Reboot your Windows 8.1 vm and
continue on in Chapter 06: Your First Rails App to find out how to use Ruby and Ruby on Rails.</p>

<h2>Next Chapter</h2>

<p>Read on to learn about manual installation of Ruby on Rails on Windows:</p>

<ul>
<li><a href="http://rails-windows.github.io/60-manual-install-ruby-rails-windows.html"><strong>Manual Installation for Ruby on Rails on Windows</strong></a></li>
</ul>
      </div><!-- class="content" -->
      <div class="content wikistyle gollum">
        <h2>Comments</h2>
      </div>
      <p>Is this helpful? Your encouragement fuels the project. Please tweet or add a comment. Couldn't get something to work? For the example apps and tutorials, it's best to open an issue on GitHub so we can help you.</p>
    </div>
  </div>

  <!-- Footer -->
  <div class="footer-top bg-gray">
  <footer class="row">
    <div class="large-12 columns"><hr />
      <div class="row">
        <div class="row">
          <div class="medium-4 large-4 columns white">
           <h4>RailsApps &#183; Getting Started</h4>
           <a href="http://railsapps.github.io/ruby-and-rails.html">Ruby on Rails</a></br>
           <a href="http://railsapps.github.io/what-is-ruby-rails.html">What is Ruby on Rails?</a></br>
           <a href="http://learn-rails.com/learn-ruby-on-rails.html">Learn Ruby on Rails</a></br>
           <a href="https://tutorials.railsapps.org/rails-tutorial">Rails Tutorial</a></br>
           <a href="http://railsapps.github.io/installing-rails.html">Install Ruby on Rails</a></br>
           <a href="http://railsapps.github.io/installrubyonrails-mac.html">Install Ruby on Rails - Mac OS X</a></br>
           <a href="http://railsapps.github.io/installrubyonrails-ubuntu.html">Install Ruby on Rails - Ubuntu</a></br>
           <a href="http://rails-windows.github.io/10-install-ruby-rails-windows.html">Install Ruby on Rails - Windows</a></br>
           <a href="http://rails-windows.github.io/">Ruby on Rails for Windows</a></br>
           <a href="http://railsapps.github.io/rubyonrails-nitrous-io.html">Ruby on Rails - Nitrous.io</a></br>
           <a href="http://railsapps.github.io/updating-rails.html">Update Rails</a></br>
           <a href="http://railsapps.github.io/rails-composer/">Rails Composer</a></br>
           <a href="http://railsapps.github.io/">Rails Examples</a></br>
           <a href="http://railsapps.github.io/rails-examples-tutorials.html">Rails Starter Apps</a>
         </div>
         <div class="medium-4 large-4 columns white">
           <h4>RailsApps &#183; Articles</h4></a>
           <a href="http://railsapps.github.io/rails-foundation.html">Foundation and Rails</a></br>
           <a href="http://railsapps.github.io/twitter-bootstrap-rails.html">Bootstrap and Rails</a></br>
           <a href="http://railsapps.github.io/rails-google-analytics.html">Analytics for Rails</a></br>
           <a href="http://railsapps.github.io/rails-heroku-tutorial.html">Heroku and Rails</a></br>
           <a href="http://railsapps.github.io/rails-javascript-include-external.html">JavaScript and Rails</a></br>
           <a href="http://railsapps.github.io/rails-environment-variables.html">Rails Environment Variables</a></br>
           <a href="http://railsapps.github.io/rails-git.html">Git and GitHub with Rails</a></br>
           <a href="http://railsapps.github.io/rails-send-email.html">Send Email with Rails</a></br>
           <a href="http://railsapps.github.io/rails-haml.html">Haml and Rails</a></br>
           <a href="http://railsapps.github.io/rails-default-application-layout.html">Rails Application Layout</a></br>
           <a href="http://railsapps.github.io/rails-html5-boilerplate.html">HTML5 Boilerplate for Rails</a></br>
           <a href="http://railsapps.github.io/rails-3-2-example-gemfile.html">Example Gemfiles for Rails</a></br>
           <a href="http://railsapps.github.io/rails-application-templates.html">Rails Application Templates</a></br>
           <a href="http://railsapps.github.io/rails-product-planning.html">Rails Product Planning</a></br>
           <a href="http://railsapps.github.io/rails-project-management.html">Rails Project Management</a>
         </div>
         <div class="medium-4 large-4 columns white">
           <h4>RailsApps &#183; Tutorials</h4>
           <a href="https://tutorials.railsapps.org/rails-bootstrap">Rails and Bootstrap</a></br>
           <a href="https://tutorials.railsapps.org/rails3-bootstrap-devise-cancan">Devise with CanCan and Twitter Bootstrap</a></br>
           <a href="https://tutorials.railsapps.org/rails-stripe-membership-saas">Rails Membership Site with Stripe</a></br>
           <a href="https://tutorials.railsapps.org/rails-recurly-subscription-saas">Rails Subscription Site with Recurly</a></br>
           <a href="https://tutorials.railsapps.org/rails-prelaunch-signup">Startup Prelaunch Signup Application</a></br>
           <a href="http://railsapps.github.io/tutorial-rails-devise-rspec-cucumber.html">Devise with RSpec and Cucumber</a></br>
           <a href="http://railsapps.github.io/tutorial-rails-mongoid-devise.html">Devise with Mongoid</a></br>
           <a href="http://railsapps.github.io/tutorial-rails-mongoid-omniauth.html">OmniAuth with Mongoid</a></br>
           <a href="http://railsapps.github.io/tutorial-rails-subdomains.html">Subdomains with Devise</a></br>
           <h4>RailsApps Profile</h4></br>
           <a href="https://plus.google.com/108039160165742774777?rel=author">Google</a></br>
           <a href="https://plus.google.com/117374718581973393536" rel="publisher">Find us on Google+</a>
         </div>
       </div>
     </div>
   </div>
 </footer>
</div>
 <!-- End Footer -->


 <script src="http://rails-windows.github.io/javascript/foundation.min.js" type="text/javascript"></script>
 <script>
 $(document).foundation();

 var doc = document.documentElement;
 doc.setAttribute('data-useragent', navigator.userAgent);
 </script>


</body>
</html>
